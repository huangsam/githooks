#!/bin/bash

# Convenient paths
BASE_DIR=$(git rev-parse --show-toplevel)
SCRIPT_DIR="${BASE_DIR}/githooks"
GIT_DIR="${BASE_DIR}/.git/hooks"

# List out files
FL_NAME=$(basename "$0")
GH_ITEMS=$(find "${SCRIPT_DIR}" -maxdepth 1 -type f \
    | grep -E '(.py|.sh)$' \
    | grep -E -v "$FL_NAME" \
    | xargs basename)

# Install hooks and supporting scripts
for fl in "${GH_ITEMS}"; do
    tmp_fl=${fl%.py}
    new_fl=${tmp_fl%.sh}
    cp "${SCRIPT_DIR}/${fl}" "${GIT_DIR}/${new_fl}"
    chmod 744 "${GIT_DIR}/${new_fl}"
done

# Install commit message template in local config
cp "${SCRIPT_DIR}/git-commit-template.txt" "${GIT_DIR}/git-commit-template.txt"
git config --local commit.template "${GIT_DIR}/git-commit-template.txt"
